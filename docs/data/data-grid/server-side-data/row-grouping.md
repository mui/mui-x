---
title: Data Grid - Server-side row grouping
---

# Data Grid - Server-side row grouping [<span class="plan-premium"></span>](/x/introduction/licensing/#premium-plan 'Premium plan')

<p class="description">Implement row grouping with server-side data in the Data Grid using the Data Source layer.</p>

The Data Grid Premium's row grouping feature lets users create subsets of rows based on repeated column values or custom functions.
The Grid can render grouped rows from server-side data using the [Data Source layer](/x/react-data-grid/server-side-data/#the-solution-the-data-source-layer).

:::info
For row grouping on the client side, see [Row grouping (client side)](/x/react-data-grid/row-grouping/).
:::

The following demo uses autogenerated data from a dataset of commodities to simulate server-side row grouping.

{{"demo": "ServerSideRowGroupingFullDataGrid.js", "bg": "inline"}}

:::info
The Data Source demos use a `useMockServer` utility function to simulate server-side data fetching.
In a real-world scenario you would replace this with your own server-side data-fetching logic.

Open the Info section of your browser console to see the requests being made and the data being fetched in response.
:::

## Prerequisites

Server-side row grouping is an extension of its client-side counterpart, so we recommend reviewing [Row grouping (client side)](/x/react-data-grid/row-grouping/) to understand the underlying data structures and core implementation before proceeding.

To be able to dynamically load row-grouping data from the server, including lazy-loading of children, you must create a Data Source and pass the `dataSource` prop to the Data Grid, as detailed in the [Server-side data overview](/x/react-data-grid/server-side-data/).

## Implementating server-side row grouping

The Data Source requires the following props to implement row grouping:

- `getGroupKey()`: Returns the group key for the row.
- `getChildrenCount()`: Returns the number of children for the row; returns `-1` if there are children present but the count is not available.

```tsx
const customDataSource: GridDataSource = {
  getRows: async (params) => {
    // Fetch the data from the server
  },
  getGroupKey: (row) => {
    // Return the group key for the row, e.g. `name`
    return row.name;
  },
  getChildrenCount: (row) => {
    // Return the number of children for the row
    return row.childrenCount;
  },
};
```

In addition to `groupKeys`, the `getRows()` callback receives a `groupFields` parameter.
This corresponds to the current `rowGroupingModel`.
Use `groupFields` on the server to group the data for each `getRows()` call.

```tsx
const getRows: async (params) => {
  const urlParams = new URLSearchParams({
    // Example: JSON.stringify(['20th Century Fox', 'James Cameron'])
    groupKeys: JSON.stringify(params.groupKeys),
    // Example: JSON.stringify(['company', 'director'])
    groupFields: JSON.stringify(params.groupFields),
  });
  const getRowsResponse = await fetchRows(
    // Server should group the data based on `groupFields` and
    // extract the rows for the nested level based on `groupKeys`.
    `https://mui.com/x/api/data-grid?${urlParams.toString()}`,
  );
  return {
    rows: getRowsResponse.rows,
    rowCount: getRowsResponse.rowCount,
  };
}
```

With the required props and parameters in place, server-side row grouping should now be implemented in your Data Grid, as shown in the demo below:

{{"demo": "ServerSideRowGroupingDataGrid.js", "bg": "inline"}}

:::warning
Server-side row grouping does not support the [`colDef.groupingValueGetter()`](/x/react-data-grid/row-grouping/#using-groupingvaluegetter-for-complex-grouping-value) method because the computation is performed on the server.
Use `dataSource.getGroupKey()` to compute the group key for the row instead.
:::

## Row expansion state persistence

The Data Grid compares the IDs of the newly fetched rows with the existing tree level.
Matching rows are not recreated and they maintain their expansion state and child rows.

To drop all child rows and reset the expansion state, pass `keepChildrenExpanded` flag set to `false` to the fetch options of the [`dataSource.fetchRows()`](/x/api/data-grid/grid-api/#grid-api-prop-dataSource) API method.

Expand some rows in the following demo and use two different refetch action buttons to see the difference in the behavior.

The cache is disabled to make all server requests visible in the console.

{{"demo": "ServerSideRowGroupingExpansionPersistence.js", "bg": "inline"}}

## Error handling

If an error occurs during a `getRows()` call, the Data Grid displays an error indicator in the row group cell.
`onDataSourceError()` is also triggered with an error containing the params described in [Server-side data overview‚ÄîError handling](/x/react-data-grid/server-side-data/#error-handling).

The demo below renders a custom Snackbar component to display an error message when the requests fail, which you can simulate using the checkbox and the **Refetch rows** button at the top.

{{"demo": "ServerSideRowGroupingErrorHandling.js", "bg": "inline"}}

## Group expansion

Group expansion with server-side row grouping works similarly to how it's described in the [client-side row grouping documentation](/x/react-data-grid/row-grouping/#group-expansion).
The difference is that the data is not initially available and is fetched automatically after the Data Grid is mounted based on the `defaultGroupingExpansionDepth` and `isGroupExpandedByDefault()` props in a waterfall manner.

The following demo uses `defaultGroupingExpansionDepth={-1}` to expand all groups by default.

{{"demo": "ServerSideRowGroupingGroupExpansion.js", "bg": "inline"}}

## Reorder row grouping rows

:::warning
This feature isn't available yet, but it is planned‚Äîyou can üëç upvote [this GitHub issue](https://github.com/mui/mui-x/issues/18947) to help us prioritize it. Please don't hesitate to leave a comment or add some additional information.
:::

## API

- [DataGrid](/x/api/data-grid/data-grid/)
- [DataGridPro](/x/api/data-grid/data-grid-pro/)
- [DataGridPremium](/x/api/data-grid/data-grid-premium/)
